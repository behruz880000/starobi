<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Магазин Starmobi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/17.0.2/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/17.0.2/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
    <style>
        /* Стили остались без изменений */
    </style>
</head>
<body>
    <div id="root" class="container"></div>
    <script type="text/babel">
        const App = () => {
            const [products, setProducts] = React.useState(() => {
                const savedProducts = localStorage.getItem('products');
                return savedProducts ? JSON.parse(savedProducts) : [];
            });
            const [cart, setCart] = React.useState(() => {
                const savedCart = localStorage.getItem('cart');
                return savedCart ? JSON.parse(savedCart) : [];
            });
            const [total, setTotal] = React.useState(() => {
                const savedTotal = localStorage.getItem('total');
                return savedTotal ? parseFloat(savedTotal) : 0;
            });
            const [newProduct, setNewProduct] = React.useState({ name: '', price: '', quantity: '', image: '' });

            React.useEffect(() => {
                localStorage.setItem('products', JSON.stringify(products));
                localStorage.setItem('cart', JSON.stringify(cart));
                localStorage.setItem('total', total);
            }, [products, cart, total]);

            const addProduct = () => {
                if (!newProduct.name || !newProduct.price || !newProduct.quantity || !newProduct.image) {
                    alert('Заполните все поля!');
                    return;
                }
                setProducts([...products, { ...newProduct, id: Date.now() }]);
                setNewProduct({ name: '', price: '', quantity: '', image: '' });
            };

            const addToCart = (product) => {
                const existingProductIndex = cart.findIndex(item => item.id === product.id);
                if (existingProductIndex !== -1) {
                    const updatedCart = [...cart];
                    updatedCart[existingProductIndex].quantity += 1;
                    setCart(updatedCart);
                } else {
                    setCart([...cart, { ...product, quantity: 1 }]);
                }
                setTotal(total + parseFloat(product.price));
            };

            return (
                <div>
                    <h1>Добро пожаловать в магазин Starmobi!</h1>
                    <div className="add-product-form">
                        <input
                            type="text"
                            placeholder="Название товара"
                            value={newProduct.name}
                            onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                        />
                        <input
                            type="number"
                            placeholder="Цена"
                            value={newProduct.price}
                            onChange={(e) => setNewProduct({ ...newProduct, price: e.target.value })}
                        />
                        <input
                            type="number"
                            placeholder="Количество"
                            value={newProduct.quantity}
                            onChange={(e) => setNewProduct({ ...newProduct, quantity: e.target.value })}
                        />
                        <input
                            type="text"
                            placeholder="Ссылка на изображение"
                            value={newProduct.image}
                            onChange={(e) => setNewProduct({ ...newProduct, image: e.target.value })}
                        />
                        <button className="button" onClick={addProduct}>Добавить товар</button>
                    </div>
                    <h2>Товары</h2>
                    {products.map((product) => (
                        <div key={product.id} className="product">
                            <img src={product.image} alt={product.name} />
                            <span>{product.name} - {product.price}₽</span>
                            <button className="button" onClick={() => addToCart(product)}>Добавить в корзину</button>
                        </div>
                    ))}
                    <div className="cart">
                        <h2>Корзина</h2>
                        {cart.length === 0 ? (
                            <p>Ваша корзина пуста.</p>
                        ) : (
                            cart.map((item) => (
                                <div key={item.id}>
                                    {item.name} - {item.quantity} шт. - {item.price * item.quantity}₽
                                </div>
                            ))
                        )}
                        <h3>Общая сумма: {total}₽</h3>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
